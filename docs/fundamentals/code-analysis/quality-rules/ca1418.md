---
title: "CA1418: Use valid platform string (code analysis)"
description: "Learn about code analysis rule CA1418: Use valid platform string"
ms.date: 09/01/2020
ms.topic: reference
f1_keywords:
  - "UseValidPlatformString"
  - "CA1418"
helpviewer_keywords:
  - "UseValidPlatformString"
  - "CA1418"
author: buyaa-n
ms.author: bunamnan
---
# CA1418: Validate platform compatibility

|||
|-|-|
| **Rule ID** |CA1418|
| **Category** |[Interoperability](interoperability-warnings.md)|
| **Fix is breaking or non-breaking** |Non-breaking|

## Cause

Platform compatibility analyzer requires a valid platform name and version. Violations are reported if the platform string provided to tha the <xref:System.Runtime.Versioning.OSPlatformAttribute> constructor consists **unknown** platform name or if the optional version part is **invalid**.

## Rule description

The platform compatibility attributes derived from <xref:System.Runtime.Versioning.OSPlatformAttribute> use string literals for OS platform names with optional version part. The string should consist a **known** platform name and have no version or with a **valid** version part.

The **known** platform names list is populated from two places:

- `PlatformName` part of <xref:System.OperatingSystem> guard methods `OperatingSystem.Is(PlatformName)[VersionAtLeast]()`, for example guard method <xref:System.OperatingSystem.IsWindows?displayProperty=nameWithType> would make the `Windows` part of the known platforms.
- The project's MSBuild item group of `SupportedPlatform`s, including the default [MSBuild SupportedPlatforms list](https://github.com/dotnet/sdk/blob/main/src/Tasks/Microsoft.NET.Build.Tasks/targets/Microsoft.NET.SupportedPlatforms.props). This is the project specific knowledge of known platforms, this allows class library authors to add more platforms into the known platforms list:

   ```XML
    <ItemGroup>
      <SupportedPlatform Include="PlatformName" />
    </ItemGroup>
  ```

If the platform string contains **version** part it should be a **valid** <xref:System.Version> with a format: `major.minor[.build[.revision]]`.

### Violations

- `Solaris` is an **unknown** platform name because it is **not** included in the default [MSBuild SupportedPlatforms list](https://github.com/dotnet/sdk/blob/main/src/Tasks/Microsoft.NET.Build.Tasks/targets/Microsoft.NET.SupportedPlatforms.props) and there is **no** guard method like `OperatingSystem.IsSolaris()`in <xref:System.OperatingSystem> class.

  ```csharp
  [SupportedOSPlatform("Solaris")] // warns: The platform 'Solaris' is not a known platform name
  public void SolarisApi() { }
  ```

- `Android` is a **known** platform because there is <xref:System.OperatingSystem.IsAndroid()?displayProperty=nameWithType> guard method exist in <xref:System.OperatingSystem> type, but the version part is not valid version, it should have at least two integers separated by dot.

  ```csharp
  [UnsupportedOSPlatform("Android10")] // warns: Version '10' is not valid for platform 'Android'. Use a version with 2-4 parts for this platform.
  public void DoesNotWorkOnAndroid() { }
  ```

- `Linux` is a **known** platform because it is included in the default [MSBuild SupportedPlatforms list](https://github.com/dotnet/sdk/blob/main/src/Tasks/Microsoft.NET.Build.Tasks/targets/Microsoft.NET.SupportedPlatforms.props), also a guard <xref:System.OperatingSystem.IsLinux()?displayProperty=nameWithType> exist, but there is **no** any versioned guard like `System.OperatingSystem.IsLinuxVersionAtLeast(int,int)` exist for Linux platform, therefore no version is supported on Linux.

  ```csharp
  [SupportedOSPlatform("Linux4.8")] // warns: Version '4.8' is not valid for platform 'Linux'. Do not use versions for this platform.
  public void LinuxApi() { }
  ```

## How to fix violations

- Update the platform with known platform name, if the platform name is correct and you want to make it a known platform then add it to the MSBuild SupportedPlatforms list within your project setting:

  ```XML
    <ItemGroup>
      <SupportedPlatform Include="Solaris" />
    </ItemGroup>
  ```

  ```csharp
  [SupportedOSPlatform("Solaris")] // No warning
  public void SolarisApi() { }
  ```

- Fix the **invalid** version, for example `10` is not a valid version, use `10.0`instead.

  ```csharp
  // Before
  [UnsupportedOSPlatform("Android10")] // warns: Version '10' is not valid for platform 'Android'. Use a version with 2-4 parts for this platform.
  public void DoesNotWorkOnAndroid() { }

  // After
  [UnsupportedOSPlatform("Android10.0")] // No warning.
  public void DoesNotWorkOnAndroid() { }
  ```

- if the platform not supports a version remove the version part

  ```csharp
  // Before
  [SupportedOSPlatform("Linux4.8")] // warns: Version '4.8' is not valid for platform 'Linux'. Do not use versions for this platform.
  public void LinuxApi() { }
  
  // After
  [SupportedOSPlatform("Linux")] // No warning.
  public void LinuxApi() { }
  ```

## When to suppress warnings

Using **unknown** platform name or **invalid** version is not recommended. However, you can suppress these diagnostics by the usual means (`<NoWarn>`, .editorconfig file, or `#pragma`):

```csharp
#pragma warning disable CA1418
[SupportedOSPlatform("platform")]
#pragma warning restore CA1418
public void PlatformSpecificApi() { }
```

## See also

- [CA1416 Platform compatibility analyzer](ca1416.md)
- [Platform compatibility analyzer (conceptual)](../../../standard/analyzers/platform-compat-analyzer.md)
- [Interoperability rules](../../../framework/interop/index.md)
