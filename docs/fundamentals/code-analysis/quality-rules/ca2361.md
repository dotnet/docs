---
title: "CA2361: Ensure autogenerated class containing DataSet.ReadXml() is not used with untrusted data (code analysis)"
description: "Learn about code analysis rule CA2361: Ensure autogenerated class containing DataSet.ReadXml() is not used with untrusted data"
ms.date: 08/11/2020
ms.topic: reference
author: dotpaul
ms.author: paulming
dev_langs:
 - CSharp
f1_keywords:
  - "CA2361"
---
# CA2361: Ensure autogenerated class containing DataSet.ReadXml() is not used with untrusted data

| | Value |
|-|-|
| **Rule ID** |CA2361|
| **Category** |[Security](security-warnings.md)|
| **Fix is breaking or non-breaking** |Non-breaking|

## Cause

The <xref:System.Data.DataSet.ReadXml%2A?displayProperty=nameWithType> method was called or referenced, and is within autogenerated code.

This rule classifies autogenerated code b:

- Being inside a method named `ReadXmlSerializable`.
- The `ReadXmlSerializable` method has a <xref:System.Diagnostics.DebuggerNonUserCodeAttribute?displayProperty=nameWithType>.
- The `ReadXmlSerializable` method is within a type that has a <xref:System.ComponentModel.DesignerCategoryAttribute?displayProperty=nameWithType>.

[CA2351](ca2351.md) is a similar rule, for when <xref:System.Data.DataSet.ReadXml%2A?displayProperty=nameWithType> appears within non-autogenerated code.

## Rule description

When deserializing a <xref:System.Data.DataSet> with untrusted input, an attacker can craft malicious input to perform a denial of service attack. There may be unknown remote code execution vulnerabilities.

This rule is like [CA2351](ca2351.md), but for autogenerated code for an in-memory representation of data within a GUI application. Usually, these autogenerated classes aren't deserialized from untrusted input. Your application's usage may vary.

For more information, see [DataSet and DataTable security guidance](../../../framework/data/adonet/dataset-datatable-dataview/security-guidance.md).

## How to fix violations

- If possible, use [Entity Framework](/ef/) rather than the <xref:System.Data.DataSet>.
- Make the serialized data tamper-proof. After serialization, cryptographically sign the serialized data. Before deserialization, validate the cryptographic signature. Protect the cryptographic key from being disclosed and design for key rotations.

## When to suppress warnings

[!INCLUDE[insecure-deserializers-common-safe-to-suppress](~/includes/code-analysis/insecure-deserializers-common-safe-to-suppress.md)]

## Pseudo-code examples

### Violation

```csharp
namespace ExampleNamespace
{
    /// <summary>
    ///Represents a strongly typed in-memory cache of data.
    ///</summary>
    [global::System.Serializable()]
    [global::System.ComponentModel.DesignerCategoryAttribute("code")]
    [global::System.ComponentModel.ToolboxItem(true)]
    [global::System.Xml.Serialization.XmlSchemaProviderAttribute("GetTypedDataSetSchema")]
    [global::System.Xml.Serialization.XmlRootAttribute("Package")]
    [global::System.ComponentModel.Design.HelpKeywordAttribute("vs.data.DataSet")]
    public partial class Something : global::System.Data.DataSet {

        [global::System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [global::System.CodeDom.Compiler.GeneratedCodeAttribute("System.Data.Design.TypedDataSetGenerator", "4.0.0.0")]
        protected override void ReadXmlSerializable(global::System.Xml.XmlReader reader) {
            if ((this.DetermineSchemaSerializationMode(reader) == global::System.Data.SchemaSerializationMode.IncludeSchema)) {
                this.Reset();
                global::System.Data.DataSet ds = new global::System.Data.DataSet();
                ds.ReadXml(reader);
                if ((ds.Tables["Something"] != null)) {
                    base.Tables.Add(new SomethingTable(ds.Tables["Something"]));
                }
                this.DataSetName = ds.DataSetName;
                this.Prefix = ds.Prefix;
                this.Namespace = ds.Namespace;
                this.Locale = ds.Locale;
                this.CaseSensitive = ds.CaseSensitive;
                this.EnforceConstraints = ds.EnforceConstraints;
                this.Merge(ds, false, global::System.Data.MissingSchemaAction.Add);
                this.InitVars();
            }
            else {
                this.ReadXml(reader);
                this.InitVars();
            }
        }
    }
}
```

## Related rules

[CA2350: Ensure DataTable.ReadXml()'s input is trusted](ca2350.md)

[CA2351: Ensure DataSet.ReadXml()'s input is trusted](ca2351.md)

[CA2352: Unsafe DataSet or DataTable in serializable type can be vulnerable to remote code execution attacks](ca2352.md)

[CA2353: Unsafe DataSet or DataTable in serializable type](ca2353.md)

[CA2354: Unsafe DataSet or DataTable in deserialized object graph can be vulnerable to remote code execution attack](ca2354.md)

[CA2355: Unsafe DataSet or DataTable in deserialized object graph](ca2355.md)

[CA2356: Unsafe DataSet or DataTable in web deserialized object graph](ca2356.md)

[CA2362: Unsafe DataSet or DataTable in autogenerated serializable type can be vulnerable to remote code execution attacks](ca2362.md)
