---
description: "Learn more about: Friend access was denied to <assembly>. If you want the compiler to consider friend types in <assembly>, add the public key information in the project settings or through a command-line switch to the compiler for the project <project>."
title: "Friend access was denied to <assembly>. If you want the compiler to consider friend types in <assembly>, add the public key information in the project settings or through a command-line switch to the compiler for the project <project>."
ms.date: 07/20/2015
f1_keywords:
  - "vbc31536"
  - "bc31536"
helpviewer_keywords:
  - "BC31536"
ms.assetid: ce87cc25-ab61-4d5f-b0f8-2e87cc479d62
---
# Friend access was denied to \<assembly>. If you want the compiler to consider friend types in \<assembly>, add the public key information in the project settings or through a command-line switch to the compiler for the project \<project>.

**Error ID:** BC31536

## To correct this error

- Add the public key information in the project settings for the friend assembly.
- Use the command-line compiler switch to specify the public key:

   ```dotnetcli
   vbc /keyfile:mykey.snk /reference:friendassembly.dll mycode.vb
   ```

- Add the public key information to the `InternalsVisibleTo` attribute in the friend assembly:

   ```vb
   <Assembly: InternalsVisibleTo("YourAssembly, PublicKey=<public_key_token>")>
   ```

- Ensure both assemblies use the same strong naming key if strong naming is required.
- Check that the friend assembly declaration is correctly formatted and the assembly name matches exactly.

## See also

- <xref:System.Reflection.AssemblyName>

- [Visual Basic Command-Line Compiler](../reference/command-line-compiler/index.md)
