---
description: "Learn more about: The 'AddressOf' expression has no effect in this context because the method argument to 'AddressOf' requires a relaxed conversion to the delegate type of the event"
title: "The 'AddressOf' expression has no effect in this context because the method argument to 'AddressOf' requires a relaxed conversion to the delegate type of the event"
ms.date: 07/20/2015
f1_keywords: 
  - "vbc42328"
  - "bc42328"
helpviewer_keywords: 
  - "BC42328"
ms.assetid: 1561e5bf-b8ab-4a67-990d-c3a76e2ab353
---
# The 'AddressOf' expression has no effect in this context because the method argument to 'AddressOf' requires a relaxed conversion to the delegate type of the event

This warning occurs when you use `AddressOf` with a method in an event handler context where the method signature doesn't exactly match the event's delegate signature. Visual Basic allows *relaxed delegate conversion* in these scenarios, but the `AddressOf` operator becomes redundant because the compiler must create a wrapper delegate anyway.

## Understand relaxed delegate conversion

Visual Basic allows you to assign methods to delegates even when their signatures don't match exactly, as long as the conversion is safe. This is called *relaxed delegate conversion* and includes:

- **Widened parameter types**: A method parameter can be a wider type than the delegate parameter.
- **Widened return types**: A method return type can be narrower than the delegate return type.  
- **Omitted parameters**: A method can have fewer parameters than the delegate.
- **Dropped return values**: A function can be assigned to a `Sub` delegate.

## When this warning occurs

This warning appears when Visual Basic can handle the assignment through relaxed conversion, making the explicit `AddressOf` unnecessary.

### Complete example showing the warning

The following example shows one scenario that produces BC42328:

:::code language="vb" source="snippets/bc42328/AddressOfExample.vb" id="DocumentProcessor":::

When you compile this code, Visual Basic shows the BC42328 warning for the `AddHandler` statements that use relaxed delegate conversion.

## Why AddressOf appears to have "no effect"

The warning message states that `AddressOf` "has no effect" because Visual Basic must create a wrapper delegate for the relaxed conversion regardless. The `AddressOf` operator doesn't change how the compiler handles the conversion: the same result occurs whether you use `AddressOf` or not in relaxed conversion scenarios.

However, `AddressOf` is still syntactically required in `AddHandler` and `RemoveHandler` statements.

**Error ID:** BC42328

## To correct this error

You have several options depending on your needs. Using the `DocumentProcessor` example from previously, here are the different ways to resolve the BC42328 warning:

### Option 1: Assign to a variable first (preserves exact semantics)

```vb
Public Sub DemonstrateHandler()
    ' Create delegate variable first - this eliminates the warning
    Dim handler As EventHandler = AddressOf OnDocumentProcessed_Simple
    AddHandler DocumentProcessed, handler
End Sub
```

### Option 2: Match the delegate signature exactly

```vb
' Change the method signature to match EventHandler exactly
Private Sub OnDocumentProcessed_Simple(sender As Object, e As EventArgs)
    ' You can ignore the parameters if you don't need them
    Console.WriteLine("Document processed (simple)")
End Sub

Public Sub DemonstrateHandler()
    ' Now this works without warning
    AddHandler DocumentProcessed, AddressOf OnDocumentProcessed_Simple
End Sub
```

### Option 3: Use a lambda expression

```vb
Public Sub DemonstrateHandler()
    ' Wrap the method call in a lambda that matches the signature
    AddHandler DocumentProcessed, Sub(sender, e) OnDocumentProcessed_Simple()
    
    ' Or create a more complex lambda inline
    AddHandler DocumentProcessed, 
        Sub(sender, e) 
            Console.WriteLine($"Event from {sender}")
            OnDocumentProcessed_Simple()
        End Sub
End Sub
```

### Option 4: Use the `Handles` clause (if appropriate)

```vb
Public Class DocumentHandler
    ' Declare the event source with WithEvents
    Private WithEvents processor As DocumentProcessor
    
    ' Use Handles clause - no AddHandler needed
    Private Sub OnDocumentComplete() Handles processor.DocumentProcessed
        Console.WriteLine("Document processing is done!")
    End Sub
End Class
```

### Option 5: Direct assignment to delegate variable

```vb
Public Sub DemonstrateHandler()
    ' Assign to delegate variable then use with AddHandler
    Dim handler As EventHandler = AddressOf OnDocumentProcessed_Simple
    AddHandler DocumentProcessed, handler
End Sub
```

## When you can ignore this warning

This warning is often safe to ignore when:

- Your handler method intentionally omits parameters it doesn't need.
- You're using a simpler method signature for cleaner code.
- The performance impact is negligible for your application.
- You're prototyping or writing quick utility code where clarity matters more than efficiency.

The relaxed conversion works correctly; this warning just indicates a minor efficiency consideration. The compiler creates a wrapper delegate automatically, which adds a small performance overhead but doesn't affect functionality.

### Example of when ignoring is appropriate

```vb
Public Class QuickLogger
    Public Event LogMessage As Action(Of String, DateTime)
    
    ' Simple handler that ignores the timestamp parameter
    Private Sub WriteToConsole()
        Console.WriteLine("Something was logged")
    End Sub
    
    Public Sub SetupLogging()
        ' This generates BC42328, but it's fine for simple scenarios
        AddHandler LogMessage, AddressOf WriteToConsole
    End Sub
End Class
```

## See also

- [AddressOf Operator](../language-reference/operators/addressof-operator.md)
- [Events (Visual Basic)](../programming-guide/language-features/events/index.md)
- [Relaxed Delegate Conversion](../programming-guide/language-features/delegates/relaxed-delegate-conversion.md)
- [AddHandler Statement](../language-reference/statements/addhandler-statement.md)
- [RemoveHandler Statement](../language-reference/statements/removehandler-statement.md)
