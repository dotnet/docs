---
description: "Learn more about: The 'AddressOf' expression has no effect in this context because the method argument to 'AddressOf' requires a relaxed conversion to the delegate type of the event"
title: "The 'AddressOf' expression has no effect in this context because the method argument to 'AddressOf' requires a relaxed conversion to the delegate type of the event"
ms.date: 07/20/2015
f1_keywords: 
  - "vbc42328"
  - "bc42328"
helpviewer_keywords: 
  - "BC42328"
ms.assetid: 1561e5bf-b8ab-4a67-990d-c3a76e2ab353
---
# The 'AddressOf' expression has no effect in this context because the method argument to 'AddressOf' requires a relaxed conversion to the delegate type of the event

This warning occurs when you use `AddressOf` with a method in an event handler context where the method signature doesn't exactly match the event's delegate signature. Visual Basic allows *relaxed delegate conversion* in these scenarios, but the `AddressOf` operator becomes redundant because the compiler must create a wrapper delegate anyway.

## Understand relaxed delegate conversion

Visual Basic allows you to assign methods to delegates even when their signatures don't match exactly, as long as the conversion is safe. This is called *relaxed delegate conversion* and includes:

- **Widened parameter types**: A method parameter can be a wider type than the delegate parameter.
- **Widened return types**: A method return type can be narrower than the delegate return type.  
- **Omitted parameters**: A method can have fewer parameters than the delegate.
- **Dropped return values**: A function can be assigned to a `Sub` delegate.

## When this warning occurs

This warning appears when Visual Basic can handle the assignment through relaxed conversion, making the explicit `AddressOf` unnecessary.

### Complete example showing the warning

Here's one scenario where you'll encounter BC42328:

```vb
Public Class FileProcessor
    ' Define an event using the standard EventHandler delegate
    ' EventHandler expects: Sub(sender As Object, e As EventArgs)
    Public Event ProcessingComplete As EventHandler
    
    ' Method with exact signature - no warning
    Private Sub OnProcessingComplete(sender As Object, e As EventArgs)
        Console.WriteLine($"Processing completed by {sender}")
    End Sub
    
    ' Method with simplified signature - this causes BC42328 warning
    Private Sub OnSimpleComplete()
        Console.WriteLine("Processing is done!")
    End Sub
    
    Public Sub StartProcessing()
        ' This works fine - exact signature match
        AddHandler ProcessingComplete, AddressOf OnProcessingComplete
        
        ' This generates BC42328 warning:
        ' "The 'AddressOf' expression has no effect in this context because 
        '  the method argument to 'AddressOf' requires a relaxed conversion 
        '  to the delegate type of the event"
        AddHandler ProcessingComplete, AddressOf OnSimpleComplete
        
        ' Simulate completion
        RaiseEvent ProcessingComplete(Me, EventArgs.Empty)
    End Sub
End Class
```

When you compile this code, Visual Basic shows the BC42328 warning for the second `AddHandler` statement because `OnSimpleComplete` doesn't match the `EventHandler` signature exactly.

## Why AddressOf appears to have "no effect"

The warning message states that `AddressOf` "has no effect" because Visual Basic must create a wrapper delegate for the relaxed conversion regardless. The `AddressOf` operator doesn't change how the compiler handles the conversion: the same result occurs whether you use `AddressOf` or not in relaxed conversion scenarios.

However, `AddressOf` is still syntactically required in `AddHandler` and `RemoveHandler` statements.

**Error ID:** BC42328

## To correct this error

You have several options depending on your needs. Using the `FileProcessor` example from above, here are the different ways to resolve the BC42328 warning:

### Option 1: Assign to a variable first (preserves exact semantics)

```vb
Public Sub StartProcessing()
    ' Create delegate variable first - this eliminates the warning
    Dim handler As EventHandler = AddressOf OnSimpleComplete
    AddHandler ProcessingComplete, handler
End Sub
```

### Option 2: Match the delegate signature exactly

```vb
' Change the method signature to match EventHandler exactly
Private Sub OnSimpleComplete(sender As Object, e As EventArgs)
    ' You can ignore the parameters if you don't need them
    Console.WriteLine("Processing is done!")
End Sub

Public Sub StartProcessing()
    ' Now this works without warning
    AddHandler ProcessingComplete, AddressOf OnSimpleComplete
End Sub
```

### Option 3: Use a lambda expression

```vb
Public Sub StartProcessing()
    ' Wrap the method call in a lambda that matches the signature
    AddHandler ProcessingComplete, Sub(sender, e) OnSimpleComplete()
    
    ' Or create a more complex lambda inline
    AddHandler ProcessingComplete, 
        Sub(sender, e) 
            Console.WriteLine($"Event from {sender}")
            OnSimpleComplete()
        End Sub
End Sub
```

### Option 4: Use the `Handles` clause (if appropriate)

```vb
Public Class FileProcessor
    ' Declare the event source with WithEvents
    Private WithEvents processor As FileProcessor
    
    ' Use Handles clause - no AddHandler needed
    Private Sub OnSimpleComplete() Handles processor.ProcessingComplete
        Console.WriteLine("Processing is done!")
    End Sub
End Class
```

### Option 5: Direct assignment to delegate variable

```vb
Public Sub StartProcessing()
    ' Assign to delegate variable then use with AddHandler
    Dim handler As EventHandler = AddressOf OnSimpleComplete
    AddHandler ProcessingComplete, handler
End Sub
```

## Complete working example

Here's a full example demonstrating the warning and multiple solutions:

```vb
Imports System

Public Class DocumentProcessor
    ' Standard .NET event using EventHandler
    Public Event DocumentProcessed As EventHandler
    
    ' Custom event with different signature
    Public Event StatusChanged As Action(Of String)
    
    ' Handlers with different signatures
    
    ' Exact match for EventHandler - no warning
    Private Sub OnDocumentProcessed_Exact(sender As Object, e As EventArgs)
        Console.WriteLine("Document processed (exact signature)")
    End Sub
    
    ' Simplified handler - causes BC42328 with EventHandler
    Private Sub OnDocumentProcessed_Simple()
        Console.WriteLine("Document processed (simple)")
    End Sub
    
    ' Handler for custom event - exact match
    Private Sub OnStatusChanged_Exact(message As String)
        Console.WriteLine($"Status: {message}")
    End Sub
    
    ' Handler with ignored parameters - causes BC42328 with custom event
    Private Sub OnStatusChanged_Simple()
        Console.WriteLine("Status changed")
    End Sub
    
    Public Sub DemonstrateWarnings()
        Console.WriteLine("Setting up event handlers...")
        
        ' These work without warnings (exact matches)
        AddHandler DocumentProcessed, AddressOf OnDocumentProcessed_Exact
        AddHandler StatusChanged, AddressOf OnStatusChanged_Exact
        
        ' These generate BC42328 warnings (relaxed conversions)
        AddHandler DocumentProcessed, AddressOf OnDocumentProcessed_Simple
        AddHandler StatusChanged, AddressOf OnStatusChanged_Simple
        
        ' Fire the events
        RaiseEvent DocumentProcessed(Me, EventArgs.Empty)
        RaiseEvent StatusChanged("Processing complete")
    End Sub
    
    Public Sub DemonstrateSolutions()
        Console.WriteLine("Using solutions to avoid warnings...")
        
        ' Solution 1: Assign to variable first
        Dim handler1 As EventHandler = AddressOf OnDocumentProcessed_Simple
        AddHandler DocumentProcessed, handler1
        
        ' Solution 2: Use lambda expression
        AddHandler DocumentProcessed, Sub(s, e) OnDocumentProcessed_Simple()
        
        ' Solution 3: Direct assignment to delegate variable
        Dim handler2 As Action(Of String) = AddressOf OnStatusChanged_Simple
        AddHandler StatusChanged, handler2
        
        ' Fire the events
        RaiseEvent DocumentProcessed(Me, EventArgs.Empty)
        RaiseEvent StatusChanged("All solutions work")
    End Sub
End Class

Module Program
    Sub Main()
        Dim processor As New DocumentProcessor()
        
        Console.WriteLine("=== Demonstrating BC42328 Warning ===")
        processor.DemonstrateWarnings()
        
        Console.WriteLine()
        Console.WriteLine("=== Demonstrating Solutions ===")
        processor.DemonstrateSolutions()
        
        Console.WriteLine("Press any key to exit...")
        Console.ReadKey()
    End Sub
End Module
```

This example shows how the warning occurs in realistic scenarios and demonstrates multiple ways to resolve it.

## When you can ignore this warning

This warning is often safe to ignore when:

- Your handler method intentionally omits parameters it doesn't need.
- You're using a simpler method signature for cleaner code.
- The performance impact is negligible for your application.
- You're prototyping or writing quick utility code where clarity matters more than efficiency.

The relaxed conversion works correctly; this warning just indicates a minor efficiency consideration. The compiler creates a wrapper delegate automatically, which adds a small performance overhead but doesn't affect functionality.

### Example of when ignoring is appropriate

```vb
Public Class QuickLogger
    Public Event LogMessage As Action(Of String, DateTime)
    
    ' Simple handler that ignores the timestamp parameter
    Private Sub WriteToConsole()
        Console.WriteLine("Something was logged")
    End Sub
    
    Public Sub SetupLogging()
        ' This generates BC42328, but it's fine for simple scenarios
        AddHandler LogMessage, AddressOf WriteToConsole
    End Sub
End Class
```

## See also

- [AddressOf Operator](../language-reference/operators/addressof-operator.md)
- [Events (Visual Basic)](../programming-guide/language-features/events/index.md)
- [Relaxed Delegate Conversion](../programming-guide/language-features/delegates/relaxed-delegate-conversion.md)
- [AddHandler Statement](../language-reference/statements/addhandler-statement.md)
- [RemoveHandler Statement](../language-reference/statements/removehandler-statement.md)
