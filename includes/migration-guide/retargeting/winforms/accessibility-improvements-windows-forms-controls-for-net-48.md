### Accessibility improvements in Windows Forms controls for .NET 4.8

> [!div class="mx-tdCol2BreakAll"]
> |   |   |
> |---|---|
> |Details|The Windows Forms Framework is continuing to improve how it works with accessibility technologies to better support Windows Forms customers. These include the following changes:<ul><li>Changes to improve display during High Contrast mode.</li><li>Changes to interaction with Narrator.</li><li>Changes in the Accessible hierarchy (improving navigation through the UI Automation tree).</li></ul>|
> |Suggestion|<strong>How to opt in or out of these changes</strong>In order for the application to benefit from these changes, it must run on the .NET Framework 4.8. The application can opt in into these changes in either of the following ways:<ul><li>It is recompiled to target the .NET Framework 4.8. These accessibility changes are enabled by default on Windows Forms applications that target the .NET Framework 4.8.</li><li>It targets the .NET Framework 4.7.2 or earlier version and opts out of the legacy accessibility behaviors by adding the following [AppContext switch](https://docs.microsoft.com/dotnet/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element) to the <code>&lt;runtime&gt;</code> section of the app config file and setting it to <code>false</code>, as the following example shows.</li></ul><pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false;Switch.UseLegacyAccessibilityFeatures.2=false;Switch.UseLegacyAccessibilityFeatures.3=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>Note that to opt in to the accessibility features added in .NET Framework 4.8, you must also opt in to accessibility features of .NET Framework 4.7.1 and 4.7.2 as well. Applications that target the .NET Framework 4.8 and want to preserve the legacy accessibility behavior can opt in to the use of legacy accessibility features by explicitly setting this AppContext switch to <code>true</code>.Enabling the keyboard ToolTip invocation support requires adding the <code>Switch.System.Windows.Forms.UseLegacyToolTipDisplay=false</code> line to the AppContextSwitchOverrides value:<pre><code class="lang-xml">&#39;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false;Switch.UseLegacyAccessibilityFeatures.2=false;Switch.UseLegacyAccessibilityFeatures.3=false;Switch.System.Windows.Forms.UseLegacyToolTipDisplay=false&quot; /&gt;&#39;&#13;&#10;</code></pre>Note that enabling this feature requires opting in to the aforementioned accessibility features of .NET Framework 4.7.1 - 4.8. Also, if any of the accessibility features are not opted in but the tooltip display feature is opted in, a runtime <xref:System.NotSupportedException> will be thrown on the first access to these features. The exception message indicates that keyboard ToolTips require accessibility improvements of level 3 to be enabled.<strong>Use of OS-defined colors in High Contrast themes</strong><ul><li>Improved high-contrast themes.</li></ul><strong>Improved Narrator support</strong><ul><li>Narrator now announces the sort direction of the <xref:System.Windows.Forms.DataGridViewColumn> when announcing an accessible name of a <xref:System.Windows.Forms.DataGridViewCell>.</li></ul><strong>Improved CheckedListBox Accessibility support</strong><ul><li>Improved Narrator support for the <xref:System.Windows.Forms.CheckedListBox> control. When navigating to the <xref:System.Windows.Forms.CheckedListBox> control using the keyboard, Narrator focuses the <xref:System.Windows.Forms.CheckedListBox> item and announces it.</li><li>An empty CheckedListBox control now has a focus rectangle drawn for a virtual first item when the control becomes focused.</li></ul><strong>Improved ComboBox Accessibility support</strong><ul><li>Enabled UI Automation support for the <xref:System.Windows.Forms.ComboBox> control, with the ability to use UI Automation notifications and other UI Automation features.</li></ul><strong>Improved DataGridView Accessibility support</strong><ul><li>Enabled UI Automation support for <xref:System.Windows.Forms.DataGridView> control with ability to use UI Automation notifications and other UI Automation features.</li><li>The UI Automation element which corresponds to the <xref:System.Windows.Forms.DataGridViewComboBoxEditingControl> or <xref:System.Windows.Forms.DataGridViewTextBoxEditingControl> is now a child of corresponding editing cell.</li></ul><strong>Improved LinkLabel Accessibility support</strong><ul><li>Improved <xref:System.Windows.Forms.LinkLabel> control accessibility: Narrator announces the disabled state for the link if the corresponding <xref:System.Windows.Forms.LinkLabel> control is disabled.</li></ul><strong>Improved ProgressBar Accessibility support</strong><ul><li>Enabled UI Automation support for the <xref:System.Windows.Forms.ProgressBar> control with the ability to use UI Automation notifications and other UI Automation features. Developers are now able to use UI Automation notifications which Narrator can announce to indicate progress.</li></ul>For an overview of UI automation events overview, including UI automation notification events, see the [UI Automation Events Overview](https://docs.microsoft.com/windows/desktop/WinAuto/uiauto-eventsoverview).<strong>Improved PropertyGrid Accessibility support</strong><ul><li>Enabled UI Automation support for the <xref:System.Windows.Forms.PropertyGrid> control, with the ability to use UI Automation notifications and other UI Automation features.</li><li>The UI Automation element which corresponds to the currently edited property is now a child of the corresponding property item UI Automation element.</li><li>The UI Automation property item element is now a child of the corresponding category element if the parent <xref:System.Windows.Forms.PropertyGrid> control is set to category view.</li></ul><strong>Improved ToolStrip support</strong><ul><li>Enabled UI Automation support for the <xref:System.Windows.Forms.ToolStrip> control, with the ability to use UI Automation notifications and other UI Automation features.</li><li>Improved navigation through <xref:System.Windows.Forms.ToolStrip> items.</li><li>In items mode, Narrator focus does not disappear and does not go to hidden items.</li></ul><strong>Improved Visual cues</strong><ul><li>An empty <xref:System.Windows.Forms.CheckedListBox> control now displays a focus indicator when it receives focus.</li></ul>Note: UI automation support is enabled for controls in runtime but is not used in design time. For an overview of UI automation, see the [UI Automation Overview](https://docs.microsoft.com/dotnet/framework/ui-automation/ui-automation-overview).</p><strong>Invoking controls' ToolTips with a keyboard</strong><ul><li>Control tooltip can now be invoked by focusing the control with keyboard. This feature needs to be enabled explicitly for the application (see section <strong>&quot;How to opt in or out of these changes&quot;</strong>)</li></ul>|
> |Scope|Major|
> |Version|4.8|
> |Type|Retargeting|
