' Visual Basic .NET Document
Option Strict On

' <Snippet1>
Imports System.Text.RegularExpressions

Module RegexUtilities
    Function IsValidEmail(strIn As String) As Boolean
        ' Return true if strIn is in valid email format.
        Return Regex.IsMatch(strIn, _
               "^([0-9a-zA-Z]([-\.\w]*[0-9a-zA-Z])*@([0-9a-zA-Z][-\w]*[0-9a-zA-Z]\.)+[a-zA-Z]{2,9})$")
    End Function
End Module
' </Snippet1>

' <Snippet2>
Public Class Application
    Public Shared Sub Main()
        Dim emailAddresses() As String = {"david.jones@proseware.com", "d.j@server1.proseware.com", _
                                           "jones@ms1.proseware.com", "j.@server1.proseware.com", _
                                           "j@proseware.com9"}
        For Each emailAddress As String In emailAddresses
            If RegexUtilities.IsValidEmail(emailAddress) Then
                Console.WriteLine("Valid: {0}", emailAddress)
            Else
                Console.WriteLine("Invalid: {0}", emailAddress)
            End If
        Next
    End Sub
End Class
' The example displays the following output:
'       Valid: david.jones@proseware.com
'       Valid: d.j@server1.proseware.com
'       Valid: jones@ms1.proseware.com
'       Invalid: j.@server1.proseware.com
'       Invalid: j@proseware.com9
' </Snippet2>
